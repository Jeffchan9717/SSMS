从头到尾所有命令
root
	create user 'admin'@localhost identified by '123456';
	grant all on *.* to 'admin'@localhost;


admin  管理员
	create database school;
	ALTER DATABASE school CHARACTER SET utf8 COLLATE utf8_general_ci;
	use school;
	
	create table major_info(mID smallint primary key, mName VARCHAR(100));
	create table student_info(sID int auto_increment, mID smallint, sName VARCHAR(30), sSex tinyint, sBirthday date, sBirthplace VARCHAR(50), sCollege VARCHAR(60), sClass tinyint, primary key(sID), foreign key(mID) references  major_info(mID));
	alter table student_info add column uID varchar(100) unique;
	create table teacher_info(tID int auto_increment, mID smallint, tName VARCHAR(30), tSex tinyint, tCollege VARCHAR(60), primary key (tID), foreign key(mID) references major_info(mID));
	alter table teacher_info add column uID varchar(100);
	create table course_info(cID int auto_increment primary key, cName VARCHAR(100) not null, cCredit tinyint, cTerm VARCHAR(10));
	create table user_info(uID varchar(100) primary key, uPassword VARCHAR(100), uIdentity tinyint, uNumber int);
	create table SC(sID int, cID int, scScore tinyint, foreign key(sID) references student_info(sID), foreign key(cID) references course_info(cID), primary key(sID, cID));
	create table TC(tID int, cID int, foreign key(tID) references teacher_info(tID), foreign key(cID) references course_info(cID));

	create procedure admin_insert_major_info(mID smallint, mName varchar(100)) insert into major_info values(mID, mName);
	#call admin_insert_major_info(21, '计算机科学与技术');
	
	delimiter $$
	用$$当终结符，用完后改回分号
	delimiter ;
	
create procedure admin_insert_user_info(puID varchar(100), puPassword varchar(100), puIdentity tinyint)
begin   
 DECLARE `_HOST` CHAR(14) DEFAULT '@\'localhost\'';
 declare tempuID varchar(100);   
 set tempuID = (select uID from user_info where uID=puID);   
 if tempuID is NULL   
 then    
  if puIdentity=0     
  then
   insert into student_info(uID) values(puID);      
   insert into user_info values(puID, puPassword, puIdentity, LAST_INSERT_ID());    
	SET `puID` := CONCAT('\'', REPLACE(TRIM(`puID`), CHAR(39), CONCAT(CHAR(92), CHAR(39))), '\''),
    `puPassword` := CONCAT('\'', REPLACE(`puPassword`, CHAR(39), CONCAT(CHAR(92), CHAR(39))), '\'');
    SET @`sql` := CONCAT('CREATE USER ', `puID`, `_HOST`, ' IDENTIFIED BY ', `puPassword`);
    PREPARE `stmt` FROM @`sql`;
    EXECUTE `stmt`;   
  end if;    
  if puIdentity=1     
  then      
   insert into teacher_info(uID) values(puID);      
   insert into user_info values(puID, puPassword, puIdentity, LAST_INSERT_ID());    
	SET `puID` := CONCAT('\'', REPLACE(TRIM(`puID`), CHAR(39), CONCAT(CHAR(92), CHAR(39))), '\''),
    `puPassword` := CONCAT('\'', REPLACE(`puPassword`, CHAR(39), CONCAT(CHAR(92), CHAR(39))), '\'');
    SET @`sql` := CONCAT('CREATE USER ', `puID`, `_HOST`, ' IDENTIFIED BY ', `puPassword`);
    PREPARE `stmt` FROM @`sql`;
    EXECUTE `stmt`;
  end if;   
 end if; 
end;$$
	#call admin_insert_user_info('刘松', '123456', 0);
	#call admin_insert_user_info('张伟', '123456', 1);
	create procedure admin_select_user_info() begin  select * from user_info; end;$$
	create procedure admin_select_student_info() select * from student_info;$$
	create procedure admin_select_teacher_info() select * from student_info;$$
	create procedure admin_select_course_info() select * from course_info;$$
	create procedure student_select_course_info() select * from course_info;$$
	create procedure admin_select_course_info() select * from course_info;$$
	create procedure admin_select_major_info() select * from major_info;$$
	create procedure admin_select_SC_info() select * from SC;$$
	create procedure admin_select_TC_info() select * from TC;$$
	create procedure student_select_student_info() select * from student_info where replace(user(), '@localhost', '')=uID;$$
	create procedure student_select_student_info() select * from student_info where replace(user(), '@localhost', '')=uID;$$
	create procedure teacher_select_teacher_info() select * from teacher_info where replace(user(), '@localhost', '')=uID;$$
	添加课程
	create procedure admin_insert_course_info(pcName VARCHAR(100), pcCredit tinyint, pcTerm VARCHAR(10))
insert into course_info(cName, cCredit, cTerm) values(pcName, pcCredit, pcTerm);
$$
	#call admin_insert_course('计算机导论', 2, '201801');
	学生选课
	create procedure student_insert_SC(pcID int)
begin
	declare tempsID int;
	set tempsID=(select sID from student_info where replace(user(), '@localhost', '')=uID);
	insert into SC values(tempsID, pcID, NULL);
end
$$
	#call student_insert_SC(1);
	学生查看选课
	create procedure student_select_SC()
	select SC.sID, SC.cID, SC.scScore from SC, user_info, student_info  where
	replace(user(), '@localhost', '')=user_info.uID
	and SC.sID=student_info.sID
	and student_info.uID=user_info.uID;
$$
	#call student_select_SC;
